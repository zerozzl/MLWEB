<style>
.search-container {
	margin-bottom: 20px;
	padding: 5px 0px;
	background-color: #f8f8f8;
	border: 1px solid #dddddd;
	border-radius: 4px;
}

.form-group, .form-inline .form-group {
	margin: 5px 0px;
}

.form-group>label {
	margin-left: 10px;
	margin-right: 5px;
}

.form-group .checkbox-container {
	display:inline-block;
}

.form-group .checkbox-container>input {
	margin-left: 5px;
}

.form-inline .btn {
	padding: 6px 15px;
	margin-left: 10px;
	margin-right: 5px;
}

#indatebegin {
	width: 110px;
}

#indateend {
	width: 110px;
}

#msg-container {
	margin-bottom: 30px;
	padding: 30px 8px;
	text-align: left;
	display: none;
}

#msg-container .loading {
	text-align: center;
}

#detection-record-container {
	overflow: auto;
}

#detection-record-container>.item {
	float: left;
	margin-right: 5px;
	margin-bottom: 10px;
	background-color: #ffffff;
	border: 1px solid #dddddd;
	border-radius: 3px;
}

#detection-record-container>.item>.item-img {
	padding: 5px;
	border-bottom: 1px solid #dddddd;
}

#detection-record-container>.item>.item-info {
	padding: 5px 10px;
}

#detection-record-container>.item>.item-info>.header {
	overflow: auto;
	margin-bottom: 5px;
}

#detection-record-container>.item>.item-info>.header>.tag {
	float: left;
	font-size: 18px;
	font-weight: bold;
}

#detection-record-container>.item>.item-info>.header>.label {
	float: right;
	padding: 5px;
	font-size: 14px;
}

#detection-record-container>.item>.item-info>.body {
	margin-bottom: 5px;
}

#detection-record-container>.item>.item-info>.operator {
	text-align: right;
}

#detection-record-container>.item>.item-img>img {
	max-width: 270px;
	max-height: 270px;
}

</style>

<script>
function init_detection_record_list() {
	$.datepicker.setDefaults($.datepicker.regional['zh-CN']);
	$("#ui-datepicker-div").remove();
	$(".date-picker").datepicker({
		dateFormat: "yy-mm-dd",
		changeMonth: true,
		changeYear: true
	});
	$("#pagination-container").load("../common/pagination.html", function() {
		search_detection_record();
	});
}

function toPage(page) {
	$("#inpage").val(page);
	search_detection_record();
}

function search_detection_record() {
	var container = $("#detection-record-container"), msg_container = $("#msg-container");
	container.html("");
	msg_container.html("<div class='loading'><img src='../images/sys/loading_l.gif' /></div>");
	msg_container.show();
	$.ajax({
		traditional : true,
		type : "post",
		dataType : "json",
		cache : false,
		timeout : 10000,
		url : "findDetectionRecords.action",
		data: $("#search-form").serialize(),
		success : function(data, textStatus) {
			var pagedList = data.ajaxObj.pagedList,
					items = pagedList.currentPageList;
			if(typeof (items) != "undefined" &&　items != null
					&& items.length > 0) {
				msg_container.hide();
				fill_datacontainer(container, items);
			} else {
				msg_container.html("<p class='help-block'>暂无相关记录</p>");
			}
			init_pagination(pagedList.empty, pagedList.pageCount, pagedList.pagesDisplayed,
					pagedList.currentPage, pagedList.backPage, pagedList.fwdPage, "toPage");
		},
		error : function(jqXHR, status, errorThrown) {
			msg_container.html(ERROR_MSG);
		}
	});
}

function fill_datacontainer(container, datas) {
	for(var i = 0; i < datas.length; i++) {
		var data = datas[i], code = "";
		if(data.detectCode == 0) {
			code = "<div class='label label-primary'>未检测</div>";
		} else if(data.detectCode == 1) {
			code = "<div class='label label-success'>成功</div>";
		} else if(data.detectCode == -1) {
			code = "<div class='label label-danger'>失败</div>";
		} else {
			code = "<div class='label label-default'>异常</div>";
		}
		var item = "<div class='item'><div class='item-img'><img src=''></div>"
				+ "<div class='item-info'><div class='header'><div class='tag'><i class='icon icon-black icon-tag'></i>"
				+ data.detectTypeS + "</div>" + code + "</div><div class='body'><i class='icon icon-black icon-clock'></i>"
				+ data.detectDateS + "</div><div class='body'><i class='icon icon-black icon-user'></i>"
				+ data.visitorId + "</div><div class='operator'><button class='btn btn-primary'>详情</button></div></div></div>";
		container.append(item);
	}
}

</script>

<h2 class="page-header">检测记录</h2>
<div class="search-container">
	<form id="search-form" class="form-inline">
		<input type="hidden" id="inpage" name="inpage" value="1">
		<div class="form-group">
			<label>检测类型:</label>
			<div class="checkbox-container" style="width:280px;">
				<input type="checkbox" name="intype" value="1"> 行人检测
				<input type="checkbox" name="intype" value="2"> 人脸检测
				<input type="checkbox" name="intype" value="3"> 图像语义分割
			</div>
		</div>
		<div class="form-group">
			<label>检测结果:</label>
			<div class="checkbox-container" style="width:120px;">
				<input type="checkbox" name="incode" value="1"> 成功
				<input type="checkbox" name="incode" value="0"> 失败
			</div>
		</div>
		<div class="form-group">
			<label>检测日期:</label>
			<label for="indatebegin" class="sr-only">开始时间</label>
			<input type="text" class="form-control date-picker" id="indatebegin" name="indatebegin" placeholder="开始时间">
			<span>-</span>
			<label for="indateend" class="sr-only">结束时间</label>
			<input type="text" class="form-control date-picker" id="indateend" name="indateend" placeholder="结束时间">
		</div>
		<input type="button" class="btn btn-default" value="搜索" onclick="search_detection_record();">
	</form>
</div>

<div id="detection-record-container">
	<div class="item">
		<div class="item-img">
			<img src="../images/sys/not_found_avatar.png">
		</div>
		<div class="item-info">
			<div class="header">
				<div class="tag"><i class="icon icon-black icon-tag"></i>行人检测</div>
				<div class="label label-success">成功</div>
			</div>
			<div class="body"><i class="icon icon-black icon-clock"></i>2016-09-28 20:24:01</div>
			<div class="body"><i class="icon icon-black icon-user"></i>ff808181576b3f3e01576b4d23b60001</div>
			<div class="operator">
				<button class="btn btn-primary">详情</button>
			</div>
		</div>
	</div>
	
	<div class="item">
		<div class="item-img">
			<img src="../images/sys/not_found_avatar.png">
		</div>
		<div class="item-info">
			<div class="header">
				<div class="tag"><i class="icon icon-black icon-tag"></i>行人检测</div>
				<div class="label label-danger">成功</div>
			</div>
			<div class="body"><i class="icon icon-black icon-clock"></i>2016-09-28 20:24:01</div>
			<div class="body"><i class="icon icon-black icon-user"></i>ff808181576b3f3e01576b4d23b60001</div>
			<div class="operator">
				<button class="btn btn-primary">详情</button>
			</div>
		</div>
	</div>
</div>

<div id="msg-container"></div>
<div id="pagination-container"></div>
